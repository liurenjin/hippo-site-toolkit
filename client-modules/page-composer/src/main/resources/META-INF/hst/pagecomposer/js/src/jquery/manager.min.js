jQuery.noConflict();(function(a){a.namespace("Hippo.PageComposer.UI");Hippo.PageComposer.UI.Manager=function(){this.current=null;this.containers={};this.dropIndicator=null;this.syncRequested=false;this.init()};Hippo.PageComposer.UI.Manager.prototype={init:function(){this.overlay=a("<div/>").addClass("hst-overlay-root").appendTo(document.body);try{var b=this;a("div.componentContentWrapper").each(function(d){if(Hippo.PageComposer.UI.Factory.isContainer(this)){b._createContainer(this)}})}catch(c){console.error(c)}},_createContainer:function(c){var b=Hippo.PageComposer.UI.Factory.createOrRetrieve(c);this.containers[b.id]=b;b.render(this)},_retrieve:function(c){var b=Hippo.PageComposer.UI.Factory;var d=b.verify(c);var e=b.getById(d.id);if(e==null){Hippo.PageComposer.Main.die("Object with id "+d.id+" not found in registry")}return e},select:function(b){if(this.current!=null&&this.current.element==b){return}this.current=this._retrieve(b);this.current.select()},deselect:function(b){if(this.current!=null){this.current.deselect();this.current=null}},add:function(c,d){if(typeof this.containers[d]!=="undefined"){var b=this.containers[d];b.add(c);this.checkStateChanges()}},remove:function(e){if(!e.hasAttribute("hst:id")){e=a(e).parents(".componentContentWrapper")[0]}var f=Hippo.PageComposer.UI.Factory.verify(e);if(f.type==HST.CONTAINERITEM){var c=a(e).parents(".componentContentWrapper").attr("hst:id");var b=this.containers[c];if(!!b&&b.removeItem(f.id)){Hippo.PageComposer.UI.Factory.deleteObjectRef(f.id)}}else{if(f.type==HST.CONTAINER){var b=this.containers[f.id];if(!!b){b.remove();delete this.containers[id];Hippo.PageComposer.UI.Factory.deleteObjectRef(f.id)}}}this.checkStateChanges()},onDragStart:function(c,b){this.onDrag(c,b);a.each(this.containers,function(d,e){e.beforeDrag()})},onDrag:function(c,b){if(this.dropIndicator==null){this.dropIndicator=a('<div id="hst-drop-indicator"/>').appendTo(document.body);this.dropIndicator.css("position","absolute")}b.drawDropIndicator(c,this.dropIndicator)},onDragStop:function(){if(this.dropIndicator!=null){this.dropIndicator.remove();this.dropIndicator=null}a.each(this.containers,function(b,c){c.afterDrag()})},highlight:function(b){a.each(this.containers,function(c,d){d.highlight()})},unhighlight:function(b){a.each(this.containers,function(c,d){d.unhighlight()})},checkStateChanges:function(){a.each(this.containers,function(b,c){c.checkState()});this.sync()},requestSync:function(){this.syncRequested=true},sync:function(){if(this.syncRequested){a.each(this.containers,function(b,c){c.sync()})}this.syncRequested=false},updateSharedData:function(b){a.each(this.containers,function(c,d){d.updateSharedData(b)})},getOverlay:function(){return this.overlay}}})(jQuery);